<&| /layouts/layout, %ARGS, Nav => 1 &>

% foreach my $id ( sort keys %{$views} ) {
% my $view = $views->{"$id"};

  <div class="container col-sm-10 col-md-6 pr-4 pl-4">
    <div class="card img-fluid">
      <img class="card-img-top" src="images/<%$view->{'background'}%>" alt="view background">

      <div class="card-img-overlay">
        <img src="images/<% $view->{'theme'} %>.png" class="card-img-top" alt="...">
      </div>
    </div>
    <div class="card-body text0-center">
      <h5 class="card-title"><% $view->{"name"} %></h5>
%     foreach my $pid ( @{$view->{'pids'}} ) {
%         if ( $constants->{$pid} ) {
              <p><% $constants->{$pid}->{'shortName'} ? $constants->{$pid}->{'shortName'} : $constants->{$pid}->{'name'} %></p>
%         }
%         else {
              <p>Invalid PID found: "<%$pid%>"</p>
%         }
        <p><% $constants->{$pid} %></p>
%     }
      <a href="/edit?id=<%$id%>" class="btn btn-primary">Edit</a>
    </div>
  </div>
% }

</&>

<%init>
# Do we need to refresh config on each page load?
my $config = $c->LoadConfig();
my $views = $config->{"views"} // ();

my $constants = $c->app->{'Constants'} || ();
</%init>
